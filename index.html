<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Push To Other Repo — README</title>
  <meta name="description" content="Push To Other Repo — safe GitHub Action README" />
  <style>
    :root{
      --bg:#0f1724;
      --card:#0b1220;
      --muted:#94a3b8;
      --accent:#60a5fa;
      --accent-2:#7dd3fc;
      --text:#e6eef8;
      --mono-bg:#071026;
      --glass: rgba(255,255,255,0.03);
      --radius:10px;
      font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    }
    html,body{height:100%}
    body{
      margin:0;
      background: linear-gradient(180deg,#071128 0%, #071428 60%);
      color:var(--text);
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      padding:32px;
      box-sizing:border-box;
    }

    .container{
      max-width:1000px;
      margin:0 auto;
    }

    header{
      display:flex;
      align-items:center;
      gap:16px;
      margin-bottom:20px;
    }
    .logo{
      width:64px;
      height:64px;
      border-radius:12px;
      display:flex;
      align-items:center;
      justify-content:center;
      background:linear-gradient(135deg,var(--accent),var(--accent-2));
      box-shadow: 0 6px 20px rgba(9,30,66,0.5);
      flex:0 0 64px;
    }
    .logo svg{filter:drop-shadow(0 2px 8px rgba(0,0,0,0.4));}
    h1{margin:0;font-weight:600;font-size:22px}
    p.lead{margin:4px 0 0;color:var(--muted);font-size:14px}

    main{
      margin-top:18px;
      display:grid;
      grid-template-columns:1fr 340px;
      gap:20px;
    }

    .card{
      background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.012));
      border:1px solid rgba(255,255,255,0.03);
      padding:20px;
      border-radius:var(--radius);
      box-shadow: 0 6px 24px rgba(2,6,23,0.6);
    }

    article h2{margin-top:0;color:var(--text)}
    table{width:100%;border-collapse:collapse;margin:8px 0 18px;}
    table th, table td{padding:8px 10px;text-align:left;border-bottom:1px dashed rgba(255,255,255,0.03);font-size:14px;color:var(--muted)}
    table th{color:var(--text);font-weight:600;font-size:13px}

    pre{
      background:var(--mono-bg);
      padding:14px;
      border-radius:8px;
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, "Roboto Mono", monospace;
      font-size:13px;
      overflow:auto;
      color:#dbeafe;
      border:1px solid rgba(255,255,255,0.02);
      line-height:1.5;
      margin:10px 0;
    }

    .meta{
      color:var(--muted);
      font-size:13px;
      margin-top:10px;
    }

    .copy-btn{
      display:inline-flex;
      gap:8px;
      align-items:center;
      background:transparent;
      border:1px solid rgba(255,255,255,0.06);
      color:var(--accent-2);
      padding:6px 10px;
      border-radius:8px;
      cursor:pointer;
      font-size:13px;
      transition:all .15s;
    }
    .copy-btn:hover{transform:translateY(-2px); box-shadow:0 6px 18px rgba(9,30,66,0.35)}

    aside .card{position:sticky; top:32px}
    .sidebar-section{margin-bottom:12px}
    .small{font-size:13px;color:var(--muted)}
    .link{color:var(--accent);text-decoration:none}
    .link:hover{text-decoration:underline}

    footer{margin-top:20px;color:var(--muted);font-size:13px;text-align:center}
    @media (max-width:980px){
      main{grid-template-columns:1fr; padding-bottom:40px}
      aside .card{position:static}
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div class="logo" aria-hidden="true">
        <!-- simple icon -->
        <svg width="36" height="36" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M4 12h16" stroke="white" stroke-opacity="0.95" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/>
          <path d="M4 6h10" stroke="white" stroke-opacity="0.85" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/>
          <path d="M4 18h7" stroke="white" stroke-opacity="0.75" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </div>
      <div>
        <h1>Push To Other Repo</h1>
        <p class="lead">Safe GitHub Action — sync a folder from this repo into another repo/branch without force-push</p>
      </div>
    </header>

    <main>
      <section class="card">
        <article>
          <h2>Summary</h2>
          <p class="small">This Action clones the destination repo, copies the specified directory into it, commits any detected changes, and safely pushes them (no force-push). If the target branch is missing, it will be created. If push is rejected, a rebase + retry is attempted; if rebase fails, the action stops.</p>

          <h2>Inputs</h2>
          <table>
            <thead><tr><th>Name</th><th>Required</th><th>Description</th></tr></thead>
            <tbody>
              <tr><td><strong>source_directory</strong></td><td>Yes</td><td>Path in current repo to sync (e.g. <code>dist</code>).</td></tr>
              <tr><td><strong>destination_repository</strong></td><td>Yes</td><td>Target repo in <code>owner/repo</code> format.</td></tr>
              <tr><td><strong>target_branch</strong></td><td>Yes</td><td>Branch in destination repo (created if missing).</td></tr>
              <tr><td><strong>user_email</strong></td><td>Yes</td><td>Email used for commits.</td></tr>
              <tr><td><strong>user_name</strong></td><td>Yes</td><td>Git username used for commits.</td></tr>
              <tr><td><strong>api_token</strong></td><td>Yes</td><td>Personal Access Token (needs <code>repo</code> scope).</td></tr>
            </tbody>
          </table>

          <h2>Example workflow</h2>

          <div style="display:flex;gap:10px;align-items:center;margin-bottom:8px">
            <button class="copy-btn" data-copy-target="example-workflow">Copy workflow</button>
            <span class="small">Save as <code>.github/workflows/sync.yml</code></span>
          </div>

          <pre id="example-workflow"><code>name: Sync Folder to Another Repository

on:
  push:
    branches: ["main"]

jobs:
  sync:
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v4

      - name: Push folder to another repository
        uses: dprakash2101/push-to-other-repo@latest
        with:
          source_directory: "dist"
          destination_repository: "my-org/another-repo"
          target_branch: "main"
          user_email: "automation@example.com"
          user_name: "Sync Bot"
          api_token: ${{ secrets.REPO_PUSH_TOKEN }}</code></pre>

          <h2>How it works</h2>
          <ol>
            <li>Validate inputs</li>
            <li>Configure Git identity</li>
            <li>Clone destination repository</li>
            <li>Checkout or create target branch</li>
            <li>Rsync source directory into destination</li>
            <li>Commit if changes exist</li>
            <li>Push with <code>--ff-only</code>; if rejected, rebase & retry</li>
            <li>If rebase fails, stop (no force-push)</li>
          </ol>

          <h2>Token requirements</h2>
          <p class="small">Your token needs at least the <code>repo</code> scope (or <code>contents:write</code> for public repos).</p>

          <h2>Notes</h2>
          <ul>
            <li>Action never force-pushes.</li>
            <li>If a rebase conflict occurs, manual resolution is required.</li>
            <li>Only <code>source_directory</code> contents are synced.</li>
          </ul>
        </article>
      </section>

      <aside>
        <div class="card">
          <div class="sidebar-section">
            <strong>Author</strong>
            <div class="meta" style="margin-top:8px">
              <a class="link" href="https://github.com/dprakash2101" target="_blank" rel="noopener">Devi Prakash</a>
            </div>
          </div>

          <div class="sidebar-section">
            <strong>License</strong>
            <div class="meta" style="margin-top:8px">
              MIT — see <a class="link" href="LICENSE" target="_blank">LICENSE</a>
            </div>
          </div>

          <div class="sidebar-section">
            <strong>Quick commands</strong>
            <div class="meta" style="margin-top:8px">
              <div style="margin-bottom:8px">
                <button class="copy-btn" data-copy-target="action-yml">Copy action.yml</button>
              </div>
              <pre id="action-yml"><code>name: "Push To Other Repo"
description: "Securely sync files or folders from one repository to another without force pushes."
inputs:
  source_directory:
    required: true
  destination_repository:
    required: true
  target_branch:
    required: true
  user_email:
    required: true
  user_name:
    required: true
  api_token:
    required: true
runs:
  using: "composite"
  steps:
    - name: Install deps
      run: sudo apt-get update -y && sudo apt-get install -y rsync git
    - name: Run script
      run: chmod +x ${{ github.action_path }}/entrypoint.sh && ${{ github.action_path }}/entrypoint.sh
</code></pre>
            </div>
          </div>

          <div style="margin-top:12px">
            <a class="copy-btn" id="download-btn" href="#" download="README.md">Download README</a>
          </div>
        </div>
      </aside>
    </main>

    <footer>
      <div class="small">Generated static page — save this file as <code>index.html</code>.</div>
    </footer>
  </div>

  <script>
    // copy buttons
    document.querySelectorAll('.copy-btn').forEach(btn=>{
      btn.addEventListener('click', async (e)=>{
        const targetId = btn.getAttribute('data-copy-target');
        if(!targetId){
          // download README fallback
          if(btn.id === 'download-btn'){
            const md = `# Push To Other Repo

This GitHub Action syncs a directory from the current repository into another GitHub repository and branch.
...
(Replace ... with your README contents)`;
            const blob = new Blob([md], {type:'text/markdown'});
            const url = URL.createObjectURL(blob);
            btn.href = url;
            // allow the download to proceed
            setTimeout(()=> URL.revokeObjectURL(url), 10000);
            return;
          }
          return;
        }
        const el = document.getElementById(targetId);
        if(!el) return;
        const text = el.innerText || el.textContent;
        try{
          await navigator.clipboard.writeText(text.trim());
          btn.textContent = 'Copied ✓';
          setTimeout(()=> btn.textContent = 'Copy workflow', 1800);
        }catch(err){
          // fallback
          const ta = document.createElement('textarea');
          ta.value = text;
          document.body.appendChild(ta);
          ta.select();
          try{ document.execCommand('copy'); btn.textContent='Copied ✓'; setTimeout(()=> btn.textContent = 'Copy', 1800); }catch(e){ alert('Copy failed: ' + e) }
          document.body.removeChild(ta);
        }
      });
    });
  </script>
</body>
</html>
